<!DOCTYPE html><html lang="en"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="kikita's Blog"><title>Web Mercator 公开的小秘密 | kikita &amp; Maps</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/8.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create','UA-74191197-1','auto');ga('send','pageview');
</script></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">Web Mercator 公开的小秘密</h1><a id="logo" href="/.">kikita &amp; Maps</a><p class="description">For Tech and Fun</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> Home</i></a><a href="/archives/"><i class="fa fa-archive"> Archive</i></a><a href="/history/"><i class="fa fa-book"> Timeline</i></a><a href="/about/"><i class="fa fa-user"> About</i></a><a href="/atom.xml"><i class="fa fa-rss"> RSS</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">Web Mercator 公开的小秘密</h1><div class="post-meta">May 29, 2015<span> | </span><span class="category"><a href="/categories/木工开物/">木工开物</a></span></div><div class="post-content"><p>网上已经有好多作者都不吝笔墨，写了好多有关 Web Mercator这个坐标系的前世今生。多搜罗多摄入，我们会得到很多有用的信息。今天讨论到 3758，3857，102100，900913…… 这些ID又一石激起千层浪，看来整理总结下还是有点必要。</p>
<p><br></p>
<h1 id="Web-Mercator-如何定义？"><a href="#Web-Mercator-如何定义？" class="headerlink" title="Web Mercator 如何定义？"></a>Web Mercator 如何定义？</h1><p><br></p>
<p> 我们知道，地理数据的坐标系一般有两大类，一是地理坐标系(GCS)，是经纬度单位的椭球坐标系；二是投影坐标系(PCS)，是平面直角坐标系。</p>
<p>投影坐标系（PCS）的定义一般会包含两方面的定义信息：<br>（1）基准面/Datum — 与GCS相应<br>（2）投影方法/Projection Method</p>
<p><br></p>
<h2 id="1"><a href="#1" class="headerlink" title="1"></a>1</h2><p><strong>Web Mercator 是一个投影坐标系统，其基准面是 WGS 1984 。</strong></p>
<p><br></p>
<p>那么，第一个问题，<em>WGS 1984 是什么？</em></p>
<p>“ 世界大地坐标系是美国国防部制图局（Defence Mapping Agency， DMA）为统一世界大地坐标系统，实现全球测量标准的一致性，定义用于制图、大地、导航的坐标基准。它包括标准地球坐标框架、用于处理原始观测数据的标准椭球参考面（即基准和参考椭球）和定义标准海平面的重力等势面（大地水准面）。……”（摘自《大地坐标系统及其应用》）</p>
<p>在上面一段中可以知道，定义一个坐标系绝对是一个复杂浩大的数学工程。 我们经常听说的 WGS 1984 （或 WGS 84）就是其中一个世界大地坐标系统。我们经常使用的 GPS 的坐标参考系统也是它。</p>
<p>WGS 1984 的具体定义参数：</p>
<blockquote>
<p>GCS_WGS_1984<br>WKID: 4326 Authority: EPSG</p>
<p>Angular Unit: Degree (0.0174532925199433)<br>Prime Meridian: Greenwich (0.0)<br>Datum: D_WGS_1984<br>  Spheroid: WGS_1984<br>    Semimajor Axis: 6378137.0<br>    Semiminor Axis: 6356752.314245179<br>    Inverse Flattening: 298.257223563</p>
</blockquote>
<p>通过参数描述，我们知道 WGS 1984 是一个长半轴(a)为6378137，短半轴（b）为6356752.314245179 的椭球体，扁率(f)为298.257223563，f=(a-b)/a 。</p>
<p><img src="http://kikitamap.com/images/blogImg/SecretofWebMercator_Speriod.png" alt=""></p>
<p><br></p>
<h2 id="2"><a href="#2" class="headerlink" title="2"></a>2</h2><p><strong>Web Mercator 坐标系使用的投影方法不是严格意义的墨卡托投影，而是一个被 EPSG（European Petroleum Survey Group）称为</strong>伪墨卡托<strong>的投影方法，这个伪墨卡托投影方法的大名是 Popular Visualization Pseudo Mercator，PVPM。</strong> 看起来就觉得这个投影方法不是很严谨的样子，大众化的？受欢迎的？可视化伪墨卡托投影……</p>
<p>因为这个坐标系统是 Google Map 最先使用的，或者更确切地说，是Google 最先发明的。在投影过程中，将表示地球的参考椭球体近似的作为正球体处理（正球体半径 R = 椭球体半长轴 a）。这也是为什么在 ArcGIS 中我们经常看到这个坐标系叫 <strong>WGS 1984 Web Mercator (Auxiliary Sphere)</strong>。Auxiliary Sphere 就是在告知你，这个坐标在投影过程中，将椭球体近似为正球体做投影变换，虽然基准面是WGS 1984 椭球面。</p>
<p><img src="http://kikitamap.com/images/blogImg/SecretofWebMercator_Geodesic.png" alt=""></p>
<p>后来，Web Mercator 在 Web 地图领域被广泛使用，这个坐标系就名声大噪。尽管这个坐标系由于精度问题一度不被GIS专业人士接受，但最终 EPSG 还是给了 WKID:3857。</p>
<p>下面放一张在 EPSG 官网上找到的3857坐标的具体参数介绍，供参考：</p>
<p><img src="http://kikitamap.com/images/blogImg/SecretofWebMercator_Name.png" alt=""></p>
<p><br></p>
<p><br></p>
<h1 id="Web-Mercator-的阴暗面"><a href="#Web-Mercator-的阴暗面" class="headerlink" title="Web Mercator 的阴暗面"></a>Web Mercator 的阴暗面</h1><p><br></p>
<p>Web Mercator 无论是来自Google程序员的谬误，还是为了简化换算的有意为之，现在它都已经名正言顺的成为了 Web 底图的最受欢迎平面坐标系。</p>
<p>问题又来了，<strong>为什么这么受欢迎的坐标系还会受到GIS大咖的诟病？</strong></p>
<p>拒绝给这个坐标系分配 坐标系ID 的原话是这样的：</p>
<p><strong>“</strong> The projected coordinate reference system originally lacked an official spatial reference identifier (SRID), and the Geodesy subcommittee of the OGP’s Geomatics committee (also known as EPSG) refused to provide it with one, declaring “We have reviewed the coordinate reference system used by Microsoft, Google, etc. and believe that it is technically flawed. We will not devalue the EPSG dataset by including such inappropriate geodesy and cartography.”  <strong>”</strong></p>
<p>这不是EPSG 冷酷无情无理取闹，从技术角度看是有原因的。简而言之，主要原因在于基准面被篡改后，本来是等角投影的Mercator坐标变换算法，不再等角了，而是近似等角，也就是出现角度变形。这种变形势必影响了坐标的精度，如下是某位GIS专家给出的概要说明（闪亮的最后一条）：</p>
<p><img src="http://kikitamap.com/images/blogImg/SecretofWebMercator_darkside.png" alt=""></p>
<p>如果你想进一步关心细节，想知道这位专家对 Web Mercator 的 dark side 的深入见解，点<a href="http://hydrometronics.com/downloads/Web%20Mercator%20-%20Non-Conformal,%20Non-Mercator%20%28notes%29.pdf" target="_blank" rel="noopener">这里</a>看看。</p>
<p><br></p>
<p><br></p>
<h1 id="不再混乱的-ID"><a href="#不再混乱的-ID" class="headerlink" title="不再混乱的 ID"></a>不再混乱的 ID</h1><p><br></p>
<p>也是由于GIS专业人士的质疑，这个坐标系的ID经历了曲折的过程，好多做Web开发的朋友都感到困惑。简单地顺一下：</p>
<p><strong>OpenLayers:900913</strong>     由于得不到官方的认证ID，Google为Web Mercator 任性地制定了这个ID，自娱自乐，也祝大家玩的开心……下面可不是我编的。</p>
<blockquote>
<p>i think 900913 is great.<br>9-g<br>0-o<br>0-o<br>9-g<br>1-l<br>3-e<br>get it? 900913 is equal to google. THAT’S AMAZING ! =-)</p>
</blockquote>
<p><strong>EPSG:3785</strong>  这是 EPSG 在 2008 年给 Web Mercator 设立的WKID，但是这个坐标系的基准面是正圆球，不是WGS 1984。 存在了一段时间后被弃用。</p>
<p><strong>EPSG:3857</strong>  EPSG为 Web Wercator 最终设立的WKID，也就是现在我们常用的Web 地图的坐标系，并且给定官方命名 “<strong>WGS 84 / Pseudo-Mercator</strong>“。</p>
<p><strong>ESRI:102113</strong>   Esri内部使用ID，与 EPSG:3785 相应。已被弃用。</p>
<p><strong>ESRI:102100</strong>   Esri内部使用ID，与 EPSG:3857 相应。</p>
<p>因此，细心地话，会发现在 ArcGIS Server 的REST 服务页面中，Web Mercator 的空间参考会记做： <strong>102100(3857)</strong></p>
<p><img src="http://kikitamap.com/images/blogImg/SecretofWebMercator_3857.png" alt=""></p>
<p><br></p>
<p><br></p>
<p><br></p>
<p>这些东西其实一直都是公开的，博主没有生产这些小秘密，只是小秘密的搬运工。</p>
<p><br></p>
<p>我把自己看过的资源放在下面，共享之，文中提到的已经做链接了地，下面就不重复列举：</p>
<p><a href="http://en.wikipedia.org/wiki/Web_Mercator" target="_blank" rel="noopener">http://en.wikipedia.org/wiki/Web_Mercator</a></p>
<p><a href="http://blogs.esri.com/esri/arcgis/2014/09/25/what-does-the-nga-web-mercator-advisory-mean-for-esri-defense-and-intelligence-users/" target="_blank" rel="noopener">http://blogs.esri.com/esri/arcgis/2014/09/25/what-does-the-nga-web-mercator-advisory-mean-for-esri-defense-and-intelligence-users/</a></p>
<p><a href="http://blogs.esri.com/esri/arcgis/2012/03/05/mercators-500th-birthday/" target="_blank" rel="noopener">http://blogs.esri.com/esri/arcgis/2012/03/05/mercators-500th-birthday/</a></p>
<p><a href="http://www.sharpgis.net/post/2008/05/15/SphericalWeb-Mercator-EPSG-code-3785" target="_blank" rel="noopener">http://www.sharpgis.net/post/2008/05/15/SphericalWeb-Mercator-EPSG-code-3785</a></p>
<p><a href="http://crschmidt.net/blog/archives/243/google-projection-900913/" target="_blank" rel="noopener">http://crschmidt.net/blog/archives/243/google-projection-900913/</a></p>
<p><a href="http://forums.esri.com/Thread.asp?c=93&amp;f=984&amp;t=288607" target="_blank" rel="noopener">http://forums.esri.com/Thread.asp?c=93&amp;f=984&amp;t=288607</a></p>
</div><div><ul class="post-copyright"><li class="post-copyright-author"><strong>Author: </strong>Xiaoyan Mu</li><li class="post-copyright-link"><strong>Blog Link: </strong><a href="/2015/05/29/SecretofWebMercator/">https://www.kikitamap.com/2015/05/29/SecretofWebMercator/</a></li><li class="post-copyright-license"><strong>Copyright Declaration: </strong>The author owns the copyright, please indicate the source reproduced.</li></ul></div><br><script type="text/javascript" src="/js/share.js?v=0.0.0" async></script><a class="article-share-link" data-url="https://www.kikitamap.com/2015/05/29/SecretofWebMercator/" data-id="cks5siox0009hsi75tosofmr4" data-qrcode="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMYAAADGCAAAAACs8KCBAAACJUlEQVR42u3aQW7DMAwEwPz/0+61QGtnScUBTI1OgevanBw2kqjXKx7Hn/H7+tnnv/fn//W6Y2BgYDyWcVyOsxesFH39/Ovrp1QMDIwNGGcJlpRyDUi+oOS9b2rGwMDAWC7xTVxiYGBg3By4189JgjWZgGJgYGCsR2ey6M2D+8a1OAYGxgMZ+a779z/f0t/AwMB4FOMojvXWZjLhK1eFgYExmpEHXK/p+LEFalAPBgbGVEY+UcsjtbrgzL+C0ysYGBijGSstzOsX51tpvSZB4XcDAwNjBGMlfD/VHigUmscuBgbGIEZ1I37lsFdvyhj9DGBgYIxm9LbYvnN/9fAZBgbGPMbKJn7emMyblEns/lMVBgbGaEb1oENeXN5U+HCUY2BgDGX04jXfFKs2CZpvxMDAGMroLSDz6Mx5S/dgYGCMZuRb9r1DYL2tt7yG06khBgbGOMb67nrvWEYzWDEwMLZkVEtfgfUmptHxDgwMjA0Y+fQuLz1pRvaWxIXOBgYGxiBGM+aKJVYLLQQ9BgbGZox8glid9lVboYU2JwYGxjaMfKurBytM9Xr7hRgYGOMYR3FUl7L5kYvmwhUDA2MDRu/R+WSuehCtGuhlGAYGxmMZnw3ZlYXxUlhjYGBswOgdlajmei+mozsxMDAwgnJ7y85qNGNgYGD0AjdvT/a2zKLgxsDA2ICRRGdSeu9IWW8hjYGBsQ9jJfJ68Zr89ZamJgYGxvMYP0QsslADifVCAAAAAElFTkSuQmCC">Share</a><div class="tags"><a href="/tags/Coordinate-System/">Coordinate System</a></div><div class="post-nav"><a class="pre" href="/2015/06/05/RunnerRoutes/">为Runner做一张有质感的图</a><a class="next" href="/2015/05/26/LinuxOracleClient/">Linux下安装绿色版Oracle客户端备忘录</a></div><div id="lv-container" data-id="city" data-uid="MTAyMC8zMjMyOC84ODg5"><script>(function(d, s) {
   var j, e = d.getElementsByTagName(s)[0];
   if (typeof LivereTower === 'function') { return; }
   j = d.createElement(s);
   j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
   j.async = true;
   e.parentNode.insertBefore(j, e);
})(document, 'script');
</script></div></div></div></div><div class="pure-u-1 pure-u-md-1-4"><div id="sidebar"><div class="widget"><div class="search-form"><input id="local-search-input" placeholder="Search" type="text" name="q" results="0"/><div id="local-search-result"></div></div></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> Categories</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/木工开物/">木工开物</a><span class="category-list-count">180</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/相机里/">相机里</a><span class="category-list-count">10</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/碎碎念/">碎碎念</a><span class="category-list-count">9</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-weibo"> Weibo</i></div><iframe class="share_self" width="100%" height="400" frameborder="0" scrolling="no" src="http://widget.weibo.com/weiboshow/index.php?language=&amp;width=0&amp;height=550&amp;fansRow=2&amp;ptype=1&amp;speed=0&amp;skin=5&amp;isTitle=0&amp;noborder=0&amp;isWeibo=1&amp;isFans=0&amp;uid=1843681867&amp;verifier=34cdc83d&amp;colors=d6f3f7,ffffff,333,40759b,f7f8f8&amp;dpc=1"></iframe></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> Tags</i></div><div class="tagcloud"><a href="/tags/Map-Story/" style="font-size: 15px;">Map Story</a> <a href="/tags/Geodata/" style="font-size: 15px;">Geodata</a> <a href="/tags/CAD/" style="font-size: 15px;">CAD</a> <a href="/tags/Performance/" style="font-size: 15px;">Performance</a> <a href="/tags/Mapping/" style="font-size: 15px;">Mapping</a> <a href="/tags/ArcPad/" style="font-size: 15px;">ArcPad</a> <a href="/tags/Deployment/" style="font-size: 15px;">Deployment</a> <a href="/tags/Raster/" style="font-size: 15px;">Raster</a> <a href="/tags/Geoprocessing/" style="font-size: 15px;">Geoprocessing</a> <a href="/tags/Spatial-Analyst/" style="font-size: 15px;">Spatial Analyst</a> <a href="/tags/3D/" style="font-size: 15px;">3D</a> <a href="/tags/CityEngine/" style="font-size: 15px;">CityEngine</a> <a href="/tags/Python/" style="font-size: 15px;">Python</a> <a href="/tags/License/" style="font-size: 15px;">License</a> <a href="/tags/Spatial-Statistics/" style="font-size: 15px;">Spatial Statistics</a> <a href="/tags/ArcGIS-Pro/" style="font-size: 15px;">ArcGIS Pro</a> <a href="/tags/Linux/" style="font-size: 15px;">Linux</a> <a href="/tags/ArcGIS-Enterprise/" style="font-size: 15px;">ArcGIS Enterprise</a> <a href="/tags/Web/" style="font-size: 15px;">Web</a> <a href="/tags/Coordinate-System/" style="font-size: 15px;">Coordinate System</a> <a href="/tags/CGA/" style="font-size: 15px;">CGA</a> <a href="/tags/Visual-Studio/" style="font-size: 15px;">Visual Studio</a> <a href="/tags/Certification/" style="font-size: 15px;">Certification</a> <a href="/tags/Github/" style="font-size: 15px;">Github</a> <a href="/tags/Vector-Tiles/" style="font-size: 15px;">Vector Tiles</a> <a href="/tags/Cloud-Storage/" style="font-size: 15px;">Cloud Storage</a> <a href="/tags/Webmaster/" style="font-size: 15px;">Webmaster</a> <a href="/tags/HERE-Map/" style="font-size: 15px;">HERE Map</a> <a href="/tags/HLS/" style="font-size: 15px;">HLS</a> <a href="/tags/Javascript/" style="font-size: 15px;">Javascript</a> <a href="/tags/Routing/" style="font-size: 15px;">Routing</a> <a href="/tags/Network/" style="font-size: 15px;">Network</a> <a href="/tags/Positioning/" style="font-size: 15px;">Positioning</a> <a href="/tags/Mobile-SDK/" style="font-size: 15px;">Mobile SDK</a> <a href="/tags/Android/" style="font-size: 15px;">Android</a> <a href="/tags/HERE-Platform/" style="font-size: 15px;">HERE Platform</a> <a href="/tags/Visualization/" style="font-size: 15px;">Visualization</a> <a href="/tags/HERE-Data-Hub/" style="font-size: 15px;">HERE Data Hub</a> <a href="/tags/Data-Management/" style="font-size: 15px;">Data Management</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> Recent</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2020/08/24/HDataHubCLI/">HERE Data Hub CLI</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/08/23/HStudio-intro/">玩一玩 HERE Studio</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/08/22/Thinkings2020/">特别的2020：一些特别的感想</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/04/19/HmSDK_Positioning/">HERE mSDK - Positioning</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/03/29/HmSDK_VectorTile-MFs/">HERE mSDK - Vector Tile / Map Feedback</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/03/11/HmSDK_MapRendering/">HERE mSDK - Map Rendering</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/03/09/HmSDK_QuickStart/">Quick Start of HERE SDK for Android</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/03/05/theShade/">the Shade</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/06/27/wlanNetworks/">WiFi Network Positioning</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/05/12/Icecream_Part4-Adcanced-Routing_2/">HERE MAP API - Part4 Advanced Routing - 2</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> Links</i></div><ul></ul><a href="http://zhihu.esrichina.com.cn/" title="ArcGIS知乎" target="_blank">ArcGIS知乎</a><ul></ul><a href="http://blog.newnaw.com/" title="菩提老王的葡萄架子" target="_blank">菩提老王的葡萄架子</a><ul></ul><a href="http://oopsliu.com/" title="OopsLiu" target="_blank">OopsLiu</a><ul></ul><a href="https://makeling.github.io/" title="UBUNTU SPACE" target="_blank">UBUNTU SPACE</a><ul></ul><a href="http://blog.csdn.net/kikitamoon" title="慕名ArcGIS_CSDN" target="_blank">慕名ArcGIS_CSDN</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2021 <a href="/." rel="nofollow">kikita &amp; Maps.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/3.3.5/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/3.3.5/jquery.fancybox.min.css"><script type="text/javascript" src="/js/search.js?v=0.0.0"></script><script>var search_path = 'search.xml';
if (search_path.length == 0) {
   search_path = 'search.xml';
}
var path = '/' + search_path;
searchFunc(path, 'local-search-input', 'local-search-result');
</script><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>